'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var React = require('react');
var useIntersectionObserver = require('../hooks/useIntersectionObserver.js');
var useIcon = require('../hooks/useIcon.js');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var React__default = /*#__PURE__*/_interopDefaultLegacy(React);

var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));
var __objRest = (source, exclude) => {
  var target = {};
  for (var prop in source)
    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)
      target[prop] = source[prop];
  if (source != null && __getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(source)) {
      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))
        target[prop] = source[prop];
    }
  return target;
};
const InnerIcon = (props, ref) => {
  const _a = props, { name, style } = _a, rest = __objRest(_a, ["name", "style"]);
  const fallbackRef = React.useRef(null);
  const iconRef = ref || fallbackRef;
  const isVisible = useIntersectionObserver.useIntersectionObserver(iconRef, {});
  const { icon, error } = useIcon.useIcon(name, isVisible);
  if (!name)
    return null;
  if (error)
    return /* @__PURE__ */ React__default["default"].createElement("span", {
      style: { fontSize: (style == null ? void 0 : style.fontSize) || "1em" }
    }, "\u2757");
  const isColorIcon = ["Colored", "TwoTone", "Flags"].some(
    (el) => name.endsWith(el)
  );
  const getStyleNormalIcon = () => {
    const basicStyle = __spreadProps(__spreadValues({}, style), {
      display: "inline-block",
      width: (style == null ? void 0 : style.fontSize) || "1em",
      height: (style == null ? void 0 : style.fontSize) || "1em",
      WebkitMaskSize: "contain",
      WebkitMaskRepeat: "no-repeat",
      WebkitMaskPosition: "center",
      verticalAlign: "middle"
    });
    if (icon) {
      basicStyle.WebkitMaskImage = `url("${icon}")`;
      basicStyle.background = (style == null ? void 0 : style.color) || "currentColor";
    }
    return basicStyle;
  };
  const getStyleColorIcon = () => {
    style == null ? true : delete style.backgroundColor;
    const styleColor = __spreadProps(__spreadValues({}, style), {
      display: "inline-block",
      width: (style == null ? void 0 : style.fontSize) || "1em",
      height: (style == null ? void 0 : style.fontSize) || "1em",
      backgroundSize: (style == null ? void 0 : style.backgroundSize) || "contain",
      backgroundRepeat: "no-repeat",
      backgroundPosition: "center",
      verticalAlign: "middle"
    });
    if (icon)
      styleColor.backgroundImage = `url("${icon}")`;
    return styleColor;
  };
  return /* @__PURE__ */ React__default["default"].createElement("span", __spreadValues({
    ref: iconRef,
    style: isColorIcon ? getStyleColorIcon() : getStyleNormalIcon()
  }, rest));
};
const Icon = React__default["default"].forwardRef(InnerIcon);

exports.Icon = Icon;
